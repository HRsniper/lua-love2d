# 🎨 Capítulo 7: Gráficos e Imagens

## 🎯 Objetivo

Ensinar como utilizar a biblioteca `love.graphics` para desenhar formas geométricas, textos, imagens e sprites, com foco em aplicações práticas para jogos.

---

## 🧱 7.1 Desenhando Formas Básicas

LÖVE2D permite desenhar retângulos, círculos, linhas e pontos com facilidade usando a biblioteca `love.graphics`.

### Retângulo

```lua
function love.draw()
    love.graphics.setColor(1, 0, 0) -- vermelho (R, G, B em valores 0-1)
    love.graphics.rectangle("fill", 100, 100, 200, 100)
    -- Parâmetros: modo, x, y, largura, altura
end
```

### Círculo

```lua
function love.draw()
    love.graphics.setColor(0, 0, 1) -- azul
    love.graphics.circle("fill", 300, 300, 50)
    -- Parâmetros: modo, x, y, raio
end
```

### Linha

```lua
function love.draw()
    love.graphics.setColor(0, 1, 0) -- verde
    love.graphics.line(100, 100, 400, 400)
    -- Parâmetros: x1, y1, x2, y2
end
```

### Exemplo Combinado

```lua
function love.draw()
    -- Fundo escuro
    love.graphics.setColor(0.1, 0.1, 0.1)
    love.graphics.rectangle("fill", 0, 0, 800, 600)

    -- Retângulo vermelho
    love.graphics.setColor(1, 0, 0)
    love.graphics.rectangle("fill", 100, 100, 200, 100)

    -- Círculo azul
    love.graphics.setColor(0, 0, 1)
    love.graphics.circle("fill", 300, 300, 50)

    -- Linha verde
    love.graphics.setColor(0, 1, 0)
    love.graphics.line(100, 100, 400, 400)
end
```

---

## 🖋️ 7.2 Exibindo Texto

### Texto Básico

```lua
function love.draw()
    love.graphics.setColor(1, 1, 1) -- branco
    love.graphics.print("Pontuação: 100", 10, 10)
    -- Parâmetros: texto, x, y
end
```

### Customizando Fontes

```lua
function love.load()
    fonte_pequena = love.graphics.newFont(16)
    fonte_grande = love.graphics.newFont(32)
    fonte_titulo = love.graphics.newFont(48)
end

function love.draw()
    -- Título
    love.graphics.setFont(fonte_titulo)
    love.graphics.setColor(1, 1, 0) -- amarelo
    love.graphics.print("MEU JOGO", 300, 50)

    -- Informações do jogo
    love.graphics.setFont(fonte_pequena)
    love.graphics.setColor(1, 1, 1) -- branco
    love.graphics.print("Pontuação: 1500", 10, 10)
    love.graphics.print("Vidas: 3", 10, 30)
    love.graphics.print("Nível: 2", 10, 50)
end
```

### Texto Centralizado

```lua
function love.draw()
    local texto = "GAME OVER"
    local fonte = love.graphics.getFont()
    local largura = fonte:getWidth(texto)
    local altura = fonte:getHeight()

    local x = (love.graphics.getWidth() - largura) / 2
    local y = (love.graphics.getHeight() - altura) / 2

    love.graphics.setColor(1, 0, 0)
    love.graphics.print(texto, x, y)
end
```

---

## 🖼️ 7.3 Carregando Imagens

### Passo a Passo

1. Coloque a imagem na pasta do projeto (ex: `player.png`)
2. Use `love.graphics.newImage()` para carregar
3. Use `love.graphics.draw()` para desenhar

### Exemplo Básico

```lua
function love.load()
    jogadorImg = love.graphics.newImage("player.png")
end

function love.draw()
    love.graphics.draw(jogadorImg, 100, 100)
    -- Parâmetros: imagem, x, y
end
```

### Exemplo com Movimento

```lua
function love.load()
    jogadorImg = love.graphics.newImage("player.png")
    jogadorX = 100
    jogadorY = 100
    velocidade = 200
end

function love.update(dt)
    if love.keyboard.isDown("right") then
        jogadorX = jogadorX + velocidade * dt
    end
    if love.keyboard.isDown("left") then
        jogadorX = jogadorX - velocidade * dt
    end
    if love.keyboard.isDown("up") then
        jogadorY = jogadorY - velocidade * dt
    end
    if love.keyboard.isDown("down") then
        jogadorY = jogadorY + velocidade * dt
    end
end

function love.draw()
    love.graphics.draw(jogadorImg, jogadorX, jogadorY)
end
```

---

## 🧩 7.4 Trabalhando com Sprites

Sprites são imagens que representam personagens ou objetos. Você pode desenhá-los com rotação, escala e origem.

### Exemplo com Rotação

```lua
function love.load()
    img = love.graphics.newImage("player.png")
    angulo = 0
    x = 300
    y = 300
end

function love.update(dt)
    angulo = angulo + dt -- rotaciona 1 radiano por segundo
end

function love.draw()
    love.graphics.draw(img, x, y, angulo, 1, 1, img:getWidth()/2, img:getHeight()/2)
    -- Parâmetros: imagem, x, y, rotação, escalaX, escalaY, origemX, origemY
end
```

### Exemplo com Escala

```lua
function love.load()
    img = love.graphics.newImage("player.png")
    escala = 1
    crescendo = true
end

function love.update(dt)
    if crescendo then
        escala = escala + dt
        if escala > 2 then
            crescendo = false
        end
    else
        escala = escala - dt
        if escala < 0.5 then
            crescendo = true
        end
    end
end

function love.draw()
    love.graphics.draw(img, 300, 300, 0, escala, escala, img:getWidth()/2, img:getHeight()/2)
end
```

---

## 🧠 7.5 Animações com Quads

Quads permitem exibir partes específicas de uma imagem, útil para spritesheets (várias sprites em uma imagem).

Se a imagem tem dimensões de `200x50` e contém `4 quadros` em uma única linha:

-   **Largura de cada quadro**: `200 / 4 = 50 px`
-   **Altura de cada quadro**: `50 px

Se houver margem externa ou espaçamento entre quadros, ajuste os valores:

-   `margin = 10 px`, `padding = 5 px`
-   `x = margin + (col * (quadHeight + padding)) = 230 px`
-   `col = 4` quadros em uma linha

### Exemplo Básico

```lua
function love.load()
    spriteSheet = love.graphics.newImage("spritesheet.png")
    quad = love.graphics.newQuad(0, 0, 32, 32, spriteSheet:getDimensions())
    -- Parâmetros: x, y, largura, altura, largura_total, altura_total
end

function love.draw()
    love.graphics.draw(spriteSheet, quad, 100, 100)
end
```

### Animação de Caminhada

```lua
function love.load()
    spriteSheet = love.graphics.newImage("walk_cycle.png")
    quads = {}

    -- Criar quads para cada frame da animação (4 frames de 32x32)
    for i = 0, 3 do
        quads[i] = love.graphics.newQuad(i * 32, 0, 32, 32, spriteSheet:getDimensions())
    end

    frameAtual = 0
    tempoFrame = 0
    velocidadeAnimacao = 0.2
end

function love.update(dt)
    tempoFrame = tempoFrame + dt

    if tempoFrame >= velocidadeAnimacao then
        frameAtual = (frameAtual + 1) % 4
        tempoFrame = 0
    end
end

function love.draw()
    love.graphics.draw(spriteSheet, quads[frameAtual], 100, 100)
end
```

Para 'flipar' uma imagem: `draw( texture, quad, x, y, radians, scale factor x, scale factor y, offset x, offset y)` é necessário passar o valor `-1` para a terceira parâmetro (scale factor x). Isso, isso faz com que a imagem seja invertida horizontalmente.

Exemplo:

```lua
love.graphics.draw( spriteSheet, quads[frameAtual], player.x, player.y, nil, -1, 1, quadWidth, nil)
```

---

## 🧩 7.6 Desafio Guiado: Personagem Completo

Vamos criar um personagem que:

-   Se move com as teclas
-   Exibe uma pontuação no canto da tela

```lua
function love.load()
    -- Carregamento de recursos
    jogadorImg = love.graphics.newImage("player.png")
    fonte = love.graphics.newFont(24)
    love.graphics.setFont(fonte)

    -- Variáveis do jogador
    jogador = {
        x = 400,
        y = 300,
        angulo = 0,
        velocidade = 200,
        width = 50,
        height = 50
    }

    -- Variáveis do jogo
    pontuacao = 0
    tempo = 0

    quads = {}
    -- Criar quads para cada frame da animação (4 frames de 50x50)
    for i = 0, 3 do
        quads[i] = love.graphics.newQuad(i * jogador.width, 0, jogador.width, jogador.height,
            jogadorImg:getDimensions())
    end

    frameAtual = 0
    velocidadeAnimacao = 0.2
    tempoFrame = 0
end

function love.update(dt)
    -- Movimentação do jogador
    if love.keyboard.isDown("right", "d") then
        jogador.x = jogador.x + jogador.velocidade * dt
    end
    if love.keyboard.isDown("left", "a") then
        jogador.x = jogador.x - jogador.velocidade * dt
    end
    if love.keyboard.isDown("up", "w") then
        jogador.y = jogador.y - jogador.velocidade * dt
    end
    if love.keyboard.isDown("down", "s") then
        jogador.y = jogador.y + jogador.velocidade * dt
    end

    -- Rotação lenta
    jogador.angulo = jogador.angulo + dt * 0.5

    -- Sistema de pontuação baseado no tempo
    tempo          = tempo + dt
    pontuacao      = math.floor(tempo * 10)

    -- Manter jogador na tela
    local top      = jogadorImg:getHeight() - jogador.height
    local left     = jogadorImg:getWidth() - (jogador.width * 4)
    local bottom   = love.graphics.getHeight() - jogadorImg:getHeight()
    local right    = love.graphics.getWidth() - (jogadorImg:getWidth() - (jogador.width * 3))
    jogador.x      = math.max(left, math.min(right, jogador.x))
    jogador.y      = math.max(top, math.min(bottom, jogador.y))


    tempoFrame = tempoFrame + dt
    if tempoFrame >= velocidadeAnimacao then
        frameAtual = (frameAtual + 1) % 4
        tempoFrame = 0
    end
end

function love.draw()
    -- Fundo
    -- Cor #282A36
    love.graphics.setBackgroundColor(40 / 255, 42 / 255, 54 / 255)

    -- Jogador
    love.graphics.setColor(1, 1, 1)
    love.graphics.draw(
        jogadorImg,
        quads[frameAtual],
        jogador.x,
        jogador.y
    )

    -- Interface
    love.graphics.setColor(1, 1, 1)
    love.graphics.print("Pontuação: " .. pontuacao, 10, 10)
    love.graphics.print("Tempo: " .. math.floor(tempo) .. "s", 10, 40)

    -- Instruções
    love.graphics.setColor(0.8, 0.8, 0.8)
    love.graphics.print("Use WASD ou setas para mover", 10, love.graphics.getHeight() - 30)
end
```

---

## 📚 Conceitos Extras

### Transparência (Alpha)

```lua
function love.draw()
    love.graphics.setColor(1, 0, 0, 0.5) -- 50% transparente
    love.graphics.circle("fill", 200, 200, 50)
end
```

### Modos de Desenho

```lua
function love.draw()
    -- Preenchido
    love.graphics.rectangle("fill", 100, 100, 100, 50)

    -- Contorno
    love.graphics.rectangle("line", 250, 100, 100, 50)
end
```

### Salvando e Restaurando Estado

```lua
function love.draw()
    love.graphics.push() -- salva estado atual
    love.graphics.rotate(math.pi/4) -- rotaciona 45 graus
    love.graphics.translate(200, 200) -- move origem

    love.graphics.rectangle("fill", 0, 0, 100, 50)

    love.graphics.pop() -- restaura estado anterior
end
```

---

## ✅ Conclusão do Capítulo

Você aprendeu:

**Formas Básicas**: Como desenhar retângulos, círculos, linhas e pontos usando `love.graphics`

**Sistema de Texto**: Como exibir textos, alterar fontes e centralizar mensagens na tela

**Carregamento de Imagens**: Como carregar arquivos de imagem e desenhá-los na tela

**Manipulação de Sprites**: Como aplicar rotação, escala e definir pontos de origem para sprites

**Animações com Quads**: Como usar spritesheets para criar animações frame a frame

**Projeto Prático**: Como combinar todos os elementos para criar um personagem interativo completo

### 💡 Dicas de Boas Práticas

-   Sempre carregue imagens na função `love.load()` para melhor performance
-   Use `love.graphics.push()` e `love.graphics.pop()` para preservar estados gráficos
-   Organize seus recursos em pastas separadas (imagens/, sons/, fontes/)
-   Considere usar atlas de sprites para jogos maiores
-   Teste sempre em diferentes resoluções de tela
