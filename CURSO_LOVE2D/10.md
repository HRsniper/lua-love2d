# üîä Cap√≠tulo 10: √Åudio e M√∫sica

## üéØ Objetivo

Ensinar como carregar, reproduzir e controlar sons e m√∫sicas usando a biblioteca `love.audio`, aplicando esses recursos em situa√ß√µes pr√°ticas como efeitos de tiro, m√∫sica de fundo e feedback sonoro para criar experi√™ncias mais imersivas.

---

## üìÅ 10.1 Tipos de √Åudio em L√ñVE2D

### Compara√ß√£o dos Tipos de Source

| Tipo       | Descri√ß√£o                             | Uso Recomendado               | Vantagens                              | Desvantagens                          |
| ---------- | ------------------------------------- | ----------------------------- | -------------------------------------- | ------------------------------------- |
| `"static"` | Carrega o som inteiro na mem√≥ria      | Efeitos sonoros curtos (< 5s) | Reprodu√ß√£o instant√¢nea, baixa lat√™ncia | Consome mais RAM                      |
| `"stream"` | Reproduz o som em tempo real do disco | M√∫sicas longas, narra√ß√£o      | Economia de mem√≥ria                    | Pequena lat√™ncia, dependente do disco |

### Formatos Suportados

L√ñVE2D suporta v√°rios formatos de √°udio:

-   **WAV**: Qualidade m√°xima, sem compress√£o
-   **OGG**: Boa qualidade, compress√£o eficiente
-   **MP3**: Compatibilidade ampla, compress√£o boa
-   **FLAC**: Qualidade sem perdas, arquivo maior

### Exemplo de Estrutura de Projeto

```
meu_jogo/
‚îú‚îÄ‚îÄ main.lua
‚îú‚îÄ‚îÄ assets/
‚îÇ   ‚îú‚îÄ‚îÄ sounds/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ shoot.wav       # Efeito de tiro
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ explosion.wav   # Explos√£o
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pickup.wav      # Coleta de item
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ hurt.wav        # Dano recebido
‚îÇ   ‚îî‚îÄ‚îÄ music/
‚îÇ       ‚îú‚îÄ‚îÄ background.ogg  # M√∫sica de fundo
‚îÇ       ‚îú‚îÄ‚îÄ menu.ogg        # M√∫sica do menu
‚îÇ       ‚îî‚îÄ‚îÄ victory.ogg     # M√∫sica de vit√≥ria
```

---

## üéµ 10.2 Carregando e Reproduzindo Sons

### Exemplo B√°sico: Som de Tiro

```lua
function love.load()
    -- Carregar som de tiro (static para resposta r√°pida)
    somTiro = love.audio.newSource("assets/sounds/shoot.wav", "static")

    -- Configura√ß√µes opcionais
    somTiro:setVolume(0.7) -- Volume a 70%
end

function love.keypressed(tecla)
    if tecla == "space" then
        -- Reproduzir som
        somTiro:play()
    end
end
```

### Sistema Completo de Efeitos Sonoros

Exemplo:

```lua
function love.load()
    -- Tabela para organizar todos os sons
    sons = {
        tiro = love.audio.newSource("assets/sounds/shoot.wav", "static"),
        explosao = love.audio.newSource("assets/sounds/explosion.wav", "static"),
        coleta = love.audio.newSource("assets/sounds/pickup.wav", "static"),
        dano = love.audio.newSource("assets/sounds/hurt.wav", "static"),
        vitoria = love.audio.newSource("assets/sounds/victory.wav", "static")
    }

    -- Configurar volumes individuais
    sons.tiro:setVolume(0.5)
    sons.explosao:setVolume(0.8)
    sons.coleta:setVolume(0.6)
    sons.dano:setVolume(0.7)
    sons.vitoria:setVolume(1.0)
end

function tocarSom(nome)
    if sons[nome] then
        -- Para o som se j√° estiver tocando (evita sobreposi√ß√£o)
        sons[nome]:stop()
        sons[nome]:play()
    else
        print("Som n√£o encontrado: " .. nome)
    end
end

function love.keypressed(tecla)
    if tecla == "space" then
        tocarSom("tiro")
    end
end

-- Exemplo de uso em colis√µes
function verificarColisoes()
    if colidiu(jogador, inimigo) then
        tocarSom("dano")
    end

    if colidiu(jogador, moeda) then
        tocarSom("coleta")
    end
end
```

### Varia√ß√µes de Som para Mais Realismo

```lua
function love.load()
    -- M√∫ltiplas varia√ß√µes do mesmo som
    sonsTiro = {
        love.audio.newSource("assets/shoot.ogg", "static"),
        love.audio.newSource("assets/hitsound.ogg", "static"),
    }

    for i, som in ipairs(sonsTiro) do
        som:setVolume(0.5)
    end
end

function tocarTiroAleatorio()
    local indice = math.random(1, #sonsTiro)
    sonsTiro[indice]:stop()
    sonsTiro[indice]:play()
end

function love.keypressed(tecla)
    if tecla == "space" then
        -- Reproduzir som
        tocarTiroAleatorio()
    end
end
```

---

## üé∂ 10.3 M√∫sica de Fundo

### Exemplo B√°sico: M√∫sica em Loop

```lua
function love.load()
    -- Carregar m√∫sica (stream para economizar mem√≥ria)
    musica = love.audio.newSource("assets/music/background.ogg", "stream")

    -- Configurar para repetir infinitamente
    musica:setLooping(true)

    -- Definir volume
    musica:setVolume(0.3)

    -- Iniciar reprodu√ß√£o
    musica:play()
end
```

### Sistema Avan√ßado de M√∫sica

Exemplo:

```lua
function love.load()
    -- Sistema de m√∫sica com m√∫ltiplas faixas
    musicas = {
        menu = love.audio.newSource("assets/music/menu.ogg", "stream"),
        jogo = love.audio.newSource("assets/music/background.ogg", "stream"),
        vitoria = love.audio.newSource("assets/music/victory.ogg", "stream"),
        derrota = love.audio.newSource("assets/music/gameover.ogg", "stream")
    }

    -- Configurar todas as m√∫sicas
    for nome, musica in pairs(musicas) do
        musica:setVolume(0.4)
        if nome ~= "vitoria" and nome ~= "derrota" then
            musica:setLooping(true)
        end
    end

    musicaAtual = nil
end

function trocarMusica(nome)
    -- Parar m√∫sica atual
    if musicaAtual then
        musicaAtual:stop()
    end

    -- Iniciar nova m√∫sica
    if musicas[nome] then
        musicaAtual = musicas[nome]
        musicaAtual:play()
        print("Tocando m√∫sica: " .. nome)
    end
end

function love.load()
    -- ... c√≥digo anterior ...
    trocarMusica("menu")
end

-- Exemplo de transi√ß√µes
function iniciarJogo()
    trocarMusica("jogo")
end

function terminarJogo(vitoria)
    if vitoria then
        trocarMusica("vitoria")
    else
        trocarMusica("derrota")
    end
end
```

### Crossfade Entre M√∫sicas

Exemplo:

```lua
local transicao = {
    ativa = false,
    tempo = 0,
    duracao = 2.0, -- 2 segundos para transi√ß√£o
    musicaAtual = nil,
    proximaMusica = nil,
    volumeOriginal = 0.4
}

function iniciarTransicao(proximaMusica)
    if transicao.musicaAtual then
        transicao.ativa = true
        transicao.tempo = 0
        transicao.proximaMusica = proximaMusica
        proximaMusica:setVolume(0)
        proximaMusica:play()
    end
end

function love.update(dt)
    if transicao.ativa then
        transicao.tempo = transicao.tempo + dt
        local progresso = transicao.tempo / transicao.duracao

        if progresso >= 1 then
            -- Terminar transi√ß√£o
            transicao.musicaAtual:stop()
            transicao.proximaMusica:setVolume(transicao.volumeOriginal)
            transicao.musicaAtual = transicao.proximaMusica
            transicao.ativa = false
        else
            -- Ajustar volumes gradualmente
            transicao.musicaAtual:setVolume(transicao.volumeOriginal * (1 - progresso))
            transicao.proximaMusica:setVolume(transicao.volumeOriginal * progresso)
        end
    end
end
```

---

## üîä 10.4 Controle de Volume e Estados

### Controles B√°sicos

```lua
function love.load()
    musica = love.audio.newSource("assets/music/background.ogg", "stream")
    musica:setLooping(true)

    -- Configura√ß√µes de volume
    volumeMusica = 0.5
    volumeEfeitos = 0.7
    musicaMutada = false

    musica:setVolume(volumeMusica)
    musica:play()
end

function ajustarVolumeMusica(delta)
    volumeMusica = math.max(0, math.min(1, volumeMusica + delta))
    musica:setVolume(volumeMusica)
    print("Volume da m√∫sica: " .. math.floor(volumeMusica * 100) .. "%")
end

function toggleMusicaMute()
    musicaMutada = not musicaMutada
    if musicaMutada then
        musica:setVolume(0)
        print("M√∫sica mutada")
    else
        musica:setVolume(volumeMusica)
        print("M√∫sica reativada")
    end
end

function love.keypressed(key)
    if key == "m" then
        toggleMusicaMute()
    elseif key == "up" then
        ajustarVolumeMusica(0.1)
    elseif key == "down" then
        ajustarVolumeMusica(-0.1)
    elseif key == "p" then
        -- Pausar/despausar m√∫sica
        if musica:isPlaying() then
            musica:pause()
            print("M√∫sica pausada")
        else
            musica:play()
            print("M√∫sica retomada")
        end
    end
end
```

### Sistema de Configura√ß√µes Persistente

Exemplo:

```lua
local config = {
    volumeMusica = 0.5,
    volumeEfeitos = 0.7,
    musicaHabilitada = true,
    efeitosHabilitados = true
}

function salvarConfiguracoes()
    local conteudo = string.format(
        "volumeMusica=%f\nvolumeEfeitos=%f\nmusicaHabilitada=%s\nefeitosHabilitados=%s",
        config.volumeMusica, config.volumeEfeitos,
        tostring(config.musicaHabilitada), tostring(config.efeitosHabilitados)
    )
    love.filesystem.write("audio_config.txt", conteudo)
end

function carregarConfiguracoes()
    if love.filesystem.getInfo("audio_config.txt") then
        local conteudo = love.filesystem.read("audio_config.txt")
        for linha in conteudo:gmatch("[^\r\n]+") do
            local chave, valor = linha:match("([^=]+)=([^=]+)")
            if chave and valor then
                if chave == "volumeMusica" or chave == "volumeEfeitos" then
                    config[chave] = tonumber(valor) or config[chave]
                elseif chave == "musicaHabilitada" or chave == "efeitosHabilitados" then
                    config[chave] = (valor == "true")
                end
            end
        end
    end
end

function aplicarConfiguracoes()
    if musica then
        musica:setVolume(config.musicaHabilitada and config.volumeMusica or 0)
    end

    for _, som in pairs(sons) do
        som:setVolume(config.efeitosHabilitados and config.volumeEfeitos or 0)
    end
end
```

---

## üß† 10.5 Feedback Sonoro Avan√ßado

### Sistema de Feedback Contextual

Exemplo:

```lua
function love.load()
    -- Sons organizados por contexto
    feedback = {
        interface = {
            clique = love.audio.newSource("assets/sounds/click.wav", "static"),
            hover = love.audio.newSource("assets/sounds/hover.wav", "static"),
            erro = love.audio.newSource("assets/sounds/error.wav", "static")
        },
        jogo = {
            coleta = love.audio.newSource("assets/sounds/pickup.wav", "static"),
            dano = love.audio.newSource("assets/sounds/hurt.wav", "static"),
            morte = love.audio.newSource("assets/sounds/death.wav", "static"),
            vitoria = love.audio.newSource("assets/sounds/victory.wav", "static")
        },
        ambiente = {
            passos = love.audio.newSource("assets/sounds/footsteps.wav", "static"),
            vento = love.audio.newSource("assets/sounds/wind.wav", "stream")
        }
    }

    -- Configurar volumes por categoria
    for categoria, sons in pairs(feedback) do
        for nome, som in pairs(sons) do
            if categoria == "interface" then
                som:setVolume(0.3)
            elseif categoria == "jogo" then
                som:setVolume(0.6)
            elseif categoria == "ambiente" then
                som:setVolume(0.2)
                if nome == "vento" then
                    som:setLooping(true)
                end
            end
        end
    end
end

function tocarFeedback(categoria, nome)
    if feedback[categoria] and feedback[categoria][nome] then
        feedback[categoria][nome]:stop()
        feedback[categoria][nome]:play()
    end
end

-- Exemplo de uso em diferentes situa√ß√µes
function coletarItem(item)
    pontuacao = pontuacao + item.valor
    tocarFeedback("jogo", "coleta")

    -- Som especial para marcos importantes
    if pontuacao % 100 == 0 then
        tocarFeedback("jogo", "vitoria")
    end
end

function receberDano()
    vida = vida - 1
    tocarFeedback("jogo", "dano")

    if vida <= 0 then
        tocarFeedback("jogo", "morte")
    end
end
```

### Sistema de Sons Posicionais (3D Audio)

Exemplo:

```lua
function love.load()
    somPassos = love.audio.newSource("assets/sounds/footsteps.wav", "static")
    posicaoJogador = {x = 400, y = 300}
    posicaoListener = {x = 400, y = 300}
end

function atualizarAudio3D()
    -- Calcular dist√¢ncia entre jogador e "ouvinte"
    local dx = posicaoJogador.x - posicaoListener.x
    local dy = posicaoJogador.y - posicaoListener.y
    local distancia = math.sqrt(dx*dx + dy*dy)

    -- Ajustar volume baseado na dist√¢ncia
    local volumeDistancia = math.max(0, 1 - distancia / 300)
    somPassos:setVolume(volumeDistancia * 0.5)

    -- Calcular posi√ß√£o relativa para pan est√©reo
    local pan = math.max(-1, math.min(1, dx / 200))
    -- Note: L√ñVE2D n√£o tem pan nativo, mas pode ser simulado
end
```

---

## üß© 10.6 Desafio Guiado: Sistema de √Åudio Completo

Vamos criar um jogo com sistema de √°udio abrangente:

```lua
-- Sistema de √°udio completo para jogo
function love.load()
    -- Inicializar configura√ß√µes
    love.window.setTitle("Jogo com Sistema de √Åudio Completo")

    -- Carregar todos os sons
    audio = {
        musica = {
            menu = love.audio.newSource("assets/music/menu.ogg", "stream"),
            jogo = love.audio.newSource("assets/music/game.ogg", "stream"),
            vitoria = love.audio.newSource("assets/music/victory.ogg", "stream")
        },
        efeitos = {
            tiro = love.audio.newSource("assets/sounds/shoot.wav", "static"),
            explosao = love.audio.newSource("assets/sounds/explosion.wav", "static"),
            coleta = love.audio.newSource("assets/sounds/pickup.wav", "static"),
            dano = love.audio.newSource("assets/sounds/hurt.wav", "static"),
            clique = love.audio.newSource("assets/sounds/click.wav", "static")
        }
    }

    -- Configurar m√∫sicas
    for nome, musica in pairs(audio.musica) do
        musica:setLooping(true)
        musica:setVolume(0.4)
    end

    -- Configurar efeitos
    for nome, som in pairs(audio.efeitos) do
        som:setVolume(0.6)
    end

    -- Vari√°veis do jogo
    estadoJogo = "menu" -- "menu", "jogando", "pausado", "vitoria"
    musicaAtual = nil
    pontuacao = 0
    metaPontuacao = 50

    -- Configura√ß√µes de √°udio
    volumeMusica = 0.4
    volumeEfeitos = 0.6
    audioHabilitado = true

    -- UI
    botoes = {
        {texto = "Iniciar Jogo", x = 300, y = 200, largura = 200, altura = 50},
        {texto = "Toggle √Åudio", x = 300, y = 270, largura = 200, altura = 50},
        {texto = "Sair", x = 300, y = 340, largura = 200, altura = 50}
    }

    -- Iniciar com m√∫sica do menu
    trocarMusica("menu")
end

function trocarMusica(nome)
    -- Parar m√∫sica atual
    if musicaAtual then
        musicaAtual:stop()
    end

    -- Iniciar nova m√∫sica
    if audio.musica[nome] then
        musicaAtual = audio.musica[nome]
        if audioHabilitado then
            musicaAtual:setVolume(volumeMusica)
            musicaAtual:play()
        end
    end
end

function tocarEfeito(nome)
    if audio.efeitos[nome] and audioHabilitado then
        audio.efeitos[nome]:stop()
        audio.efeitos[nome]:setVolume(volumeEfeitos)
        audio.efeitos[nome]:play()
    end
end

function love.update(dt)
    if estadoJogo == "jogando" then
        -- Simular coleta de pontos com som
        if love.keyboard.isDown("space") then
            pontuacao = pontuacao + 1
            tocarEfeito("coleta")

            -- Verificar vit√≥ria
            if pontuacao >= metaPontuacao then
                estadoJogo = "vitoria"
                trocarMusica("vitoria")
                tocarEfeito("explosao") -- Som de comemora√ß√£o
            end
        end
    end
end

function love.draw()
    if estadoJogo == "menu" then
        -- Menu principal
        love.graphics.setColor(1, 1, 1)
        love.graphics.printf("JOGO COM √ÅUDIO", 0, 100, 800, "center")

        -- Desenhar bot√µes
        for i, botao in ipairs(botoes) do
            love.graphics.setColor(0.3, 0.3, 0.3)
            love.graphics.rectangle("fill", botao.x, botao.y, botao.largura, botao.altura)
            love.graphics.setColor(1, 1, 1)
            love.graphics.rectangle("line", botao.x, botao.y, botao.largura, botao.altura)
            love.graphics.printf(botao.texto, botao.x, botao.y + 15, botao.largura, "center")
        end

        -- Indicador de √°udio
        love.graphics.setColor(audioHabilitado and {0, 1, 0} or {1, 0, 0})
        love.graphics.print("√Åudio: " .. (audioHabilitado and "LIGADO" or "DESLIGADO"), 10, 10)

    elseif estadoJogo == "jogando" then
        -- Tela do jogo
        love.graphics.setColor(1, 1, 1)
        love.graphics.printf("PRESSIONE ESPA√áO PARA COLETAR PONTOS", 0, 200, 800, "center")
        love.graphics.printf("Pontua√ß√£o: " .. pontuacao .. "/" .. metaPontuacao, 0, 250, 800, "center")
        love.graphics.printf("Pressione P para pausar", 0, 350, 800, "center")

        -- Barra de progresso
        local larguraBarra = 400
        local progresso = pontuacao / metaPontuacao
        love.graphics.setColor(0.3, 0.3, 0.3)
        love.graphics.rectangle("fill", 200, 300, larguraBarra, 20)
        love.graphics.setColor(0, 1, 0)
        love.graphics.rectangle("fill", 200, 300, larguraBarra * progresso, 20)

    elseif estadoJogo == "pausado" then
        -- Tela de pausa
        love.graphics.setColor(0, 0, 0, 0.7)
        love.graphics.rectangle("fill", 0, 0, 800, 600)
        love.graphics.setColor(1, 1, 1)
        love.graphics.printf("JOGO PAUSADO", 0, 250, 800, "center")
        love.graphics.printf("Pressione P para continuar", 0, 300, 800, "center")
        love.graphics.printf("Pressione M para menu", 0, 350, 800, "center")

    elseif estadoJogo == "vitoria" then
        -- Tela de vit√≥ria
        love.graphics.setColor(1, 1, 0)
        love.graphics.printf("VIT√ìRIA!", 0, 200, 800, "center")
        love.graphics.setColor(1, 1, 1)
        love.graphics.printf("Pontua√ß√£o Final: " .. pontuacao, 0, 250, 800, "center")
        love.graphics.printf("Pressione R para reiniciar", 0, 300, 800, "center")
        love.graphics.printf("Pressione M para menu", 0, 350, 800, "center")
    end

    -- Controles de volume
    love.graphics.setColor(0.7, 0.7, 0.7)
    love.graphics.print("Controles:", 10, 500)
    love.graphics.print("+ / - : Volume da m√∫sica", 10, 520)
    love.graphics.print("Ctrl + / Ctrl - : Volume dos efeitos", 10, 540)
    love.graphics.print("A : Toggle √°udio", 10, 560)
end

function love.mousepressed(x, y, button)
    if button == 1 and estadoJogo == "menu" then
        for i, botao in ipairs(botoes) do
            if x >= botao.x and x <= botao.x + botao.largura and
               y >= botao.y and y <= botao.y + botao.altura then

                tocarEfeito("clique")

                if i == 1 then -- Iniciar Jogo
                    estadoJogo = "jogando"
                    pontuacao = 0
                    trocarMusica("jogo")
                elseif i == 2 then -- Toggle √Åudio
                    audioHabilitado = not audioHabilitado
                    if audioHabilitado then
                        trocarMusica("menu")
                    else
                        if musicaAtual then
                            musicaAtual:pause()
                        end
                    end
                elseif i == 3 then -- Sair
                    love.event.quit()
                end
                break
            end
        end
    end
end

function love.keypressed(key)
    if key == "p" then
        if estadoJogo == "jogando" then
            estadoJogo = "pausado"
            if musicaAtual then
                musicaAtual:pause()
            end
            tocarEfeito("clique")
        elseif estadoJogo == "pausado" then
            estadoJogo = "jogando"
            if musicaAtual and audioHabilitado then
                musicaAtual:play()
            end
            tocarEfeito("clique")
        end
    elseif key == "m" then
        if estadoJogo ~= "menu" then
            estadoJogo = "menu"
            trocarMusica("menu")
            tocarEfeito("clique")
        end
    elseif key == "r" and estadoJogo == "vitoria" then
        estadoJogo = "jogando"
        pontuacao = 0
        trocarMusica("jogo")
        tocarEfeito("clique")
    elseif key == "a" then
        audioHabilitado = not audioHabilitado
        if audioHabilitado then
            if musicaAtual then
                musicaAtual:play()
            end
        else
            if musicaAtual then
                musicaAtual:pause()
            end
        end
        tocarEfeito("clique")
    elseif key == "=" or key == "+" then
        -- Aumentar volume da m√∫sica
        volumeMusica = math.min(1, volumeMusica + 0.1)
        if musicaAtual then
            musicaAtual:setVolume(volumeMusica)
        end
        print("Volume m√∫sica: " .. math.floor(volumeMusica * 100) .. "%")
    elseif key == "-" then
        -- Diminuir volume da m√∫sica
        volumeMusica = math.max(0, volumeMusica - 0.1)
        if musicaAtual then
            musicaAtual:setVolume(volumeMusica)
        end
        print("Volume m√∫sica: " .. math.floor(volumeMusica * 100) .. "%")
    end

    -- Controle de volume dos efeitos (Ctrl + / Ctrl -)
    if love.keyboard.isDown("lctrl") or love.keyboard.isDown("rctrl") then
        if key == "=" or key == "+" then
            volumeEfeitos = math.min(1, volumeEfeitos + 0.1)
            print("Volume efeitos: " .. math.floor(volumeEfeitos * 100) .. "%")
        elseif key == "-" then
            volumeEfeitos = math.max(0, volumeEfeitos - 0.1)
            print("Volume efeitos: " .. math.floor(volumeEfeitos * 100) .. "%")
        end
    end
end

function love.quit()
    -- Parar todas as m√∫sicas ao sair
    for nome, musica in pairs(audio.musica) do
        musica:stop()
    end
end
```

---

## üìö Conceitos Avan√ßados

### Sistema de Pool de √Åudio

```lua
-- Para jogos com muitos sons simult√¢neos
local audioPool = {}

function criarPoolSom(arquivo, tamanho)
    local pool = {}
    for i = 1, tamanho do
        pool[i] = {
            source = love.audio.newSource(arquivo, "static"),
            disponivel = true
        }
    end
    return pool
end

function tocarSomPool(pool)
    for i, som in ipairs(pool) do
        if som.disponivel and not som.source:isPlaying() then
            som.disponivel = false
            som.source:play()

            -- Timer para marcar como dispon√≠vel novamente
            love.timer.schedule(function()
                som.disponivel = true
            end, som.source:getDuration())

            return
        end
    end
end
```

### An√°lise de √Åudio em Tempo Real

```lua
function love.load()
    musicaStream = love.audio.newSource("assets/music/beat.ogg", "stream")
    musicaStream:play()
end

function love.update(dt)
    -- Obter dados de √°udio (se suportado)
    if musicaStream:isPlaying() then
        local posicao = musicaStream:tell()
        local duracao = musicaStream:getDuration()
        local progresso = posicao / duracao

        -- Usar progresso para efeitos visuais
        local pulsacao = math.sin(posicao * 10) * 0.5 + 0.5
    end
end
```

---

## üîß Otimiza√ß√£o e Boas Pr√°ticas

### Carregamento Inteligente

```lua
local audioManager = {
    loaded = {},
    maxCacheSize = 50
}

function audioManager.get(arquivo, tipo)
    if not audioManager.loaded[arquivo] then
        if #audioManager.loaded >= audioManager.maxCacheSize then
            -- Remove o som menos usado
            local lruKey = audioManager.findLRU()
            audioManager.loaded[lruKey] = nil
        end

        audioManager.loaded[arquivo] = {
            source = love.audio.newSource(arquivo, tipo or "static"),
            lastUsed = love.timer.getTime()
        }
    end

    audioManager.loaded[arquivo].lastUsed = love.timer.getTime()
    return audioManager.loaded[arquivo].source
end
```

### Fallbacks para Arquivos Ausentes

```lua
function carregarSomSeguro(arquivo, tipo)
    if love.filesystem.getInfo(arquivo) then
        return love.audio.newSource(arquivo, tipo or "static")
    else
        print("Aviso: arquivo de √°udio n√£o encontrado: " .. arquivo)
        return nil
    end
end

function tocarSomSeguro(source)
    if source then
        source:play()
    end
end
```

---

## ‚úÖ Conclus√£o do Cap√≠tulo

Voc√™ aprendeu:

**Fundamentos de √Åudio**: Diferen√ßas entre tipos `static` e `stream`, formatos suportados e quando usar cada tipo adequadamente

**Sistema de M√∫sica**: Como implementar trilha sonora com transi√ß√µes suaves, crossfades e controle de estados de jogo

**Efeitos Sonoros**: Organiza√ß√£o e reprodu√ß√£o de sons de feedback, varia√ß√µes aleat√≥rias e sistemas contextuais

**Controles de √Åudio**: Implementa√ß√£o de volume, mute, pausa e configura√ß√µes persistentes para melhor experi√™ncia do usu√°rio

**Feedback Sonoro Avan√ßado**: Uso estrat√©gico de √°udio para comunicar estados do jogo, a√ß√µes do jogador e criar atmosfera imersiva

**Projeto Integrado**: Sistema completo de √°udio com menu interativo, m√∫ltiplos estados de jogo e controles avan√ßados

### üí° Dicas de Boas Pr√°ticas

-   Use `static` para sons curtos e frequentes (< 5 segundos) e `stream` para m√∫sicas longas
-   Sempre implemente controles de volume e op√ß√£o de mute para acessibilidade
-   Organize sons em categorias (interface, gameplay, ambiente) com volumes apropriados
-   Teste o jogo sem √°udio para garantir que ainda seja jog√°vel (acessibilidade para surdos)
-   Use compress√£o adequada: OGG para m√∫sica, WAV para efeitos cr√≠ticos de baixa lat√™ncia
-   Implemente fallbacks para arquivos de √°udio ausentes para evitar crashes
-   Considere usar pools de √°udio para jogos com muitos sons simult√¢neos
-   Mantenha arquivos de √°udio pequenos para reduzir tempo de carregamento
-   Teste em diferentes dispositivos para garantir compatibilidade de formatos
