# Capítulo 8: Manipulação de Tabelas

Funções de tabela: `table.insert`, `table.remove`, `table.sort`, `table.concat`.

## Exemplo 1: Inserção e remoção

```lua
local lista = {}
table.insert(lista, "maça")
table.insert(lista, "banana")
print("Lista:", table.concat(lista, ", ")) -- table.concat Juntando elementos de um array.
-- Lista: maça, banana

table.remove(lista, 2)
print("Lista após remoção:", table.concat(lista, ", ")) -- Lista após remoção: maça
```

## Exemplo 2: Ordenação

```lua
local numeros_desordenados = {5, 2, 8, 1, 9, 4}
table.sort(numeros_desordenados)
print("Números ordenados:", table.concat(numeros_desordenados, ", "))
-- Output: Números ordenados: 1, 2, 4, 5, 8, 9

local palavras = {"banana", "maçã", "laranja", "abacaxi"}
table.sort(palavras)
print("Palavras ordenadas:", table.concat(palavras, ", "))
-- Output: Palavras ordenadas: abacaxi, banana, laranja, maçã
```

## Exemplo 3: Iteração com ipairs (para arrays):

```lua
local cores = {"Vermelho", "Verde", "Azul"}

for index, cor in ipairs(cores) do
    print(index .. ": " .. cor)
end
-- Output:
-- 1: Vermelho
-- 2: Verde
-- 3: Azul
```

## Exemplo 4: Iteração com pairs (para dicionários/geral):

```lua
local livro = {
    titulo = "O Guia do Mochileiro das Galáxias",
    autor = "Douglas Adams",
    ano = 1979
}

for chave, valor in pairs(livro) do
    print(chave .. ": " .. tostring(valor))
end
-- Output (ordem pode variar):
-- titulo: O Guia do Mochileiro das Galáxias
-- autor: Douglas Adams
-- ano: 1979
```

## Exemplo 5: Iteradores com Estado Complexo

Alguns iteradores precisam manter um estado mais complexo entre as chamadas, como múltiplos contadores ou flags.

Este é um exemplo mais avançado, que pode ser visto como um protótipo. Para árvores reais, bibliotecas ou estruturas mais elaboradas são usadas.

```lua
-- Representação simples de uma árvore (usando tabelas aninhadas)
local arvore = {
  valor = "Raiz",
  filhos = {
    { valor = "Filho 1", filhos = { { valor = "Neto 1.1" } } },
    { valor = "Filho 2" }
  }
}
-- Função para obter os filhos de um nó (para iteração)
local function obter_filhos(node)
    if node and node.filhos then
        local indice = 0
        return function()
            indice = indice + 1
            return node.filhos[indice]
        end
    end
end

print("Percurso em largura (simplificado):")

local fila = { arvore } -- Começa com a raiz na fila
local proximo_no_index = 1
local ultimo_no_processo = 1

while proximo_no_index <= ultimo_no_processo do
    local node_atual = fila[proximo_no_index]
    print("Visitando:", node_atual.valor)

    if node_atual.filhos then
        for _, filho in ipairs(node_atual.filhos) do
            table.insert(fila, filho)
            ultimo_no_processo = ultimo_no_processo + 1
        end
    end

    proximo_no_index = proximo_no_index + 1
end

-- Percurso em largura (simplificado):
-- Visitando: Raiz
-- Visitando: Filho 1
-- Visitando: Filho 2
-- Visitando: Neto 1.1
```
